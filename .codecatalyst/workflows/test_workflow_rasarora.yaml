Name: test_workflow_rasarora
SchemaVersion: "1.0"
RunMode: PARALLEL
# Compute:
#   Type: EC2
#   SharedInstance: True
  
Triggers:
  - Type: PUSH
    Branches:
      - main

Actions:
  Build1:
    Identifier: aws/build-beta@v1
    Inputs:
      Sources:
        - WorkflowSource
    Configuration:
      Compute:
        Fleet: test-fleet-rasarora
        Type: EC2
      Steps:
        - Run: pwd
        - Run: ls -l
        - Run: env
        - Run: echo $CATALYST_SOURCE_DIR_Build1
      Caching:
        FileCaching:
          - KeyName: key1
            Path: /codeaws/output
            RestoreKeys:
              - restore_key1
  Build2:
    Identifier: aws/build-beta@v1
    DependsOn:
      - Build1
    Configuration:
      Compute:
        Fleet: test-fleet-rasarora
        Type: EC2
      Steps:
        - Run: pwd
        - Run: ls -l
        - Run: cd /codeaws/output
        - Run: ls -l
        - Run: echo $CATALYST_SOURCE_DIR_Build1
        - Run: echo $CATALYST_SOURCE_DIR_Build2
      Caching:
        FileCaching:
          - KeyName: key1
            Path: /codeaws/output
